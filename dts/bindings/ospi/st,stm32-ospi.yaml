# Copyright (c) 2022 STMicroelectronics
# SPDX-License-Identifier: Apache-2.0

description: |
    STM32 OSPI device representation. A stm32 octospi node would typically
    looks to this:

        &octospi {
            pinctrl-0 = <&octospi_clk_pe9 &octospi_ncs_pe10 &octospi_dqs_pe11
                         &octospi_bk1_io0_pe12 &octospi_bk1_io1_pe13
                         &octospi_bk1_io2_pe14 &octospi_bk1_io3_pe15
                         &octospi_bk1_io4_pe16 &octospi_bk1_io5_pe17
                         &octospi_bk1_io6_pe18 &octospi_bk1_io7_pe19>;

            dmas = <&dma1 5 41 0x10000>;
            dma-names = "tx_rx";

            status = "okay";
        };

compatible: "st,stm32-ospi"

include: [base.yaml, pinctrl-device.yaml]

bus: ospi

properties:
    reg:
      required: true

    interrupts:
      required: true

    pinctrl-0:
      required: true

    pinctrl-names:
      required: true

    dmas:
      description: |
        Optional DMA channel specifier. If DMA should be used, specifier should
        hold a phandle reference to the dma controller, the channel number,
        the slot number, channel configuration and finally features.
        Even if a dmamux exists, the dma node is used (&dma1, &dma2)
        The dma channel is always given from 0 to Max-Channel minus 1
        The request is given by the DMAMUX if present : must be enabled in the DTS.
        Only the config bits priority and periph/mem datasize are used.
        The periph/mem datasize must be equal 0 is a correct value.
        There is no Fifo used by this DMA peripheral.

        For example dmas for TX/RX on OSPI
           dmas = <&dma1 5 41 0x10000>;

    dma-names:
      description: |
        DMA channel name. If DMA should be used, expected value is "tx_rx".

        For example
           dma-names = "tx_rx";

    flash-id:
      type: int
      required: false
      description: |
        FLash ID number. This number, if defined, helps to select the right
        OSPI GPIO banks (defined as 'octospi_bk[12]' in pinctrl property)
        to communicate with flash memory.

        For example
           flash-id = <1>;
